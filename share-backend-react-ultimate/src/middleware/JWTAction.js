'use strict';var _0x234a26=_0x287f;(function(_0x3c6b53,_0x1e0c58){var _0x5ab813=_0x287f,_0x31f9aa=_0x3c6b53();while(!![]){try{var _0xdb6dc8=parseInt(_0x5ab813(0x1c7))/0x1*(parseInt(_0x5ab813(0x1bf))/0x2)+parseInt(_0x5ab813(0x1b8))/0x3+-parseInt(_0x5ab813(0x1c6))/0x4*(parseInt(_0x5ab813(0x1cc))/0x5)+parseInt(_0x5ab813(0x1de))/0x6+parseInt(_0x5ab813(0x1b9))/0x7*(-parseInt(_0x5ab813(0x1b4))/0x8)+-parseInt(_0x5ab813(0x1c0))/0x9+-parseInt(_0x5ab813(0x1cf))/0xa*(-parseInt(_0x5ab813(0x1bc))/0xb);if(_0xdb6dc8===_0x1e0c58)break;else _0x31f9aa['push'](_0x31f9aa['shift']());}catch(_0x555a02){_0x31f9aa['push'](_0x31f9aa['shift']());}}}(_0xa974,0x782df));var _jsonwebtoken=_interopRequireDefault(require(_0x234a26(0x1b7))),_lodash=require('lodash'),_uuid=require('uuid'),_index=_interopRequireDefault(require('../models/index')),_bcryptjs=_interopRequireDefault(require(_0x234a26(0x1ba)));function _0xa974(){var _0x38da0f=['4aftfWc','50LUUxxH','split','/account','verify','some','613965CvyMfn','dotenv','url','10jZXWND','json','exports','status','/logout','default','delay','authorization','user','groupWithRoles','__esModule','/register','LTNWW','[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?','/participant/all','5153094hsnPon','config','path','length','env','body','152BIPTbD','/participant','JWT\x20Token\x20đã\x20hết\x20hạn.\x20Bạn\x20cần\x20dùng\x20Refresh_Token\x20để\x20lấy\x20token\x20mới,\x20or\x20Login\x20lại\x20và\x20sử\x20dụng\x20Access_Token\x20mới\x20:v','jsonwebtoken','207441gnHaCI','106869WfswaK','bcryptjs','Bearer','1483999mlmeIO','email','cookies','24866edmJXh','7014906vOkSnP','JWT_SECRET','/refresh-token','TokenExpiredError','headers','uCuJw'];_0xa974=function(){return _0x38da0f;};return _0xa974();}function _interopRequireDefault(_0x4ee0a3){var _0x177acf=_0x234a26;return _0x4ee0a3&&_0x4ee0a3[_0x177acf(0x1d9)]?_0x4ee0a3:{'default':_0x4ee0a3};}require(_0x234a26(0x1cd))[_0x234a26(0x1df)]();var nonSecurePaths=[_0x234a26(0x1d3),'/login',_0x234a26(0x1da),_0x234a26(0x1c2),_0x234a26(0x1b5),_0x234a26(0x1dd)],verifyToken=function(_0xfdcb4){var _0x50f49f=_0x234a26,_0x905819=process[_0x50f49f(0x1e2)][_0x50f49f(0x1c1)],_0x2eb4b9=null;try{_0x2eb4b9=_jsonwebtoken[_0x50f49f(0x1d4)][_0x50f49f(0x1ca)](_0xfdcb4,_0x905819);}catch(_0x4bebfb){if(_0x50f49f(0x1db)!==_0x50f49f(0x1c5)){if(_0x4bebfb instanceof _jsonwebtoken[_0x50f49f(0x1d4)][_0x50f49f(0x1c3)])return'TokenExpiredError';}else _0x264aed();}return _0x2eb4b9;},extractToken=function(_0x45b74e){var _0xf49b7f=_0x234a26;return _0x45b74e[_0xf49b7f(0x1c4)]['authorization']&&_0xf49b7f(0x1bb)===_0x45b74e['headers'][_0xf49b7f(0x1d6)][_0xf49b7f(0x1c8)]('\x20')[0x0]?_0x45b74e[_0xf49b7f(0x1c4)][_0xf49b7f(0x1d6)][_0xf49b7f(0x1c8)]('\x20')[0x1]:null;},checkUserJWT=function(_0x42f9d6,_0x11acc2,_0x58cbd1){var _0x40e5e7=_0x234a26;if(nonSecurePaths['includes'](_0x42f9d6[_0x40e5e7(0x1e0)]))return _0x58cbd1();var _0x36f704=_0x42f9d6[_0x40e5e7(0x1be)],_0x338669=extractToken(_0x42f9d6);return _0x36f704&&_0x36f704['access_token']||_0x338669?(_0x36f704=_0x36f704&&_0x36f704['access_token']?_0x36f704['access_token']:_0x338669,(_0x338669=verifyToken(_0x36f704))&&_0x40e5e7(0x1c3)!==_0x338669?(_0x42f9d6[_0x40e5e7(0x1d7)]=_0x338669,void _0x58cbd1()):_0x338669&&_0x40e5e7(0x1c3)===_0x338669?_0x11acc2[_0x40e5e7(0x1d2)](0x195)['json']({'EC':-0x3e7,'DT':'','EM':_0x40e5e7(0x1b6)}):_0x11acc2[_0x40e5e7(0x1d2)](0x191)[_0x40e5e7(0x1d0)]({'EC':-0x1,'DT':'','EM':_0x40e5e7(0x1dc)})):_0x11acc2['status'](0x191)[_0x40e5e7(0x1d0)]({'EC':-0x1,'DT':'','EM':_0x40e5e7(0x1dc)});},checkUserPermission=function(_0x21f086,_0x3b15b3,_0x42d9a6){var _0x13c540=_0x234a26;return nonSecurePaths['includes'](_0x21f086[_0x13c540(0x1e0)])||_0x13c540(0x1c9)===_0x21f086[_0x13c540(0x1e0)]?_0x42d9a6():_0x21f086[_0x13c540(0x1d7)]?(_0x21f086['user'][_0x13c540(0x1bd)],_0x32ff23=_0x21f086['user'][_0x13c540(0x1d8)]['Roles'],_0x41e303=_0x21f086[_0x13c540(0x1e0)],!_0x32ff23||0x0===_0x32ff23[_0x13c540(0x1e1)]||!0x0!==_0x32ff23[_0x13c540(0x1cb)](function(_0x677623){var _0x567ba4=_0x13c540;return _0x677623[_0x567ba4(0x1ce)]===_0x41e303||_0x41e303['includes'](_0x677623[_0x567ba4(0x1ce)]);})?_0x3b15b3[_0x13c540(0x1d2)](0x193)[_0x13c540(0x1d0)]({'EC':-0x1,'DT':'','EM':'you\x20don\x27t\x20permission\x20to\x20access\x20this\x20resource...'}):void _0x42d9a6()):_0x3b15b3[_0x13c540(0x1d2)](0x191)['json']({'EC':-0x1,'DT':'','EM':'[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?'});var _0x32ff23,_0x41e303;},addDelay=function(_0x413177,_0x4ea25f,_0x3881ae){var _0x15d087=_0x234a26,_0x36d5c2;null!=_0x413177&&null!=(_0x36d5c2=_0x413177[_0x15d087(0x1b3)])&&_0x36d5c2[_0x15d087(0x1d5)]?setTimeout(function(){_0x3881ae();},+_0x413177['body'][_0x15d087(0x1d5)]):_0x3881ae();};function _0x287f(_0x59944e,_0x2a430a){var _0xa97470=_0xa974();return _0x287f=function(_0x287f3a,_0x3d7d40){_0x287f3a=_0x287f3a-0x1b3;var _0x33ba0b=_0xa97470[_0x287f3a];return _0x33ba0b;},_0x287f(_0x59944e,_0x2a430a);}module[_0x234a26(0x1d1)]={'checkUserJWT':checkUserJWT,'checkUserPermission':checkUserPermission,'addDelay':addDelay};